var tool=function(){var a={touchWP:function(a,b,c,d,e){function f(a){switch(a){case"touchstart":return"MSPointerDown";case"touchmove":return"MSPointerMove";case"touchend":return"MSPointerUp"}return""}e=e||!1,e?window.navigator.msPointerEnabled?a.removeEventListener(f(b),c,d):a.removeEventListener(b,c,d):window.navigator.msPointerEnabled?a.addEventListener(f(b),c,d):a.addEventListener(b,c,d)},getImgSize:function(a,b){var c,d,e=new Image;e.src="../"+a;var f=function(){console.log("width:"+e.width+",height:"+e.height),(e.width>0||e.height>0)&&(c=e.height,d=e.width,clearInterval(g),b(d,c))},g=setInterval(f,40)},cssAniEvent:function(a,b,c){a.addEventListener("webkit"+b,c,!1),a.addEventListener(b.toLowerCase(),c,!1)}};return a}(),worker=function(){var a={getLocalStorage:function(){src=JSON.parse(localStorage.getItem("openImageSrc")),image=JSON.parse(localStorage.getItem("openImage")),list=Object.keys(src).filter(function(a){return!!a.match(/.jpg$/)||!!a.match(/.png$/)||!!a.match(/.bmp$/)}),pointer=list.indexOf(image.____name),render.createImg()}};return a}(),render=function(){function a(){function a(){h.removeChild(c),b=document.getElementsByClassName("last")[0],b.classList.remove("last"),b.classList.add("pointer"),b.classList.add("leftIn"),h.removeChild(f),pointer-=1,n.textContent=list[pointer],o.textContent=pointer+1+"/"+list.length,d(),tool.cssAniEvent(b,"AnimationEnd",function(){b.style.left="0px",b.classList.remove("leftIn")})}if(document.getElementsByClassName("next")[0]&&0!==pointer){var b,c=document.getElementsByClassName("pointer")[0],f=document.getElementsByClassName("next")[0];c.classList.add("rightOut"),e(a)}}function b(){if(document.getElementsByClassName("next")[0]&&pointer!==list.length){var a=document.getElementsByClassName("pointer")[0],b=document.getElementsByClassName("next")[0];b.classList.remove("next"),b.classList.add("pointer"),a.classList.add("leftOut"),tool.cssAniEvent(a,"AnimationEnd",function(){h.removeChild(a),b.classList.add("rightIn"),pointer+=1,n.textContent=list[pointer],o.textContent=pointer+1+"/"+list.length,d()}),tool.cssAniEvent(b,"AnimationEnd",function(){b.style.left="0px",b.classList.remove("rightIn")})}}function c(){function a(a){function d(a){a.stopImmediatePropagation(),e+=1,2===e&&(console.log("back"),b.width=q,h.style.overflow="hidden",c.style.display="block",tool.touchWP(i,"touchend",d,!0,!0)),setTimeout(function(){e=0},300)}if(a>q){var e=0;tool.touchWP(i,"touchend",d,!0),b.width=a,h.style.overflow="visible",c.style.display="none"}}if(document.getElementsByClassName("next")[0]&&pointer!==list.length){var b=document.getElementsByClassName("pointer")[0],c=document.getElementsByClassName("next")[0];tool.getImgSize(src.____src+"/"+list[pointer],a)}}function d(){function a(a,c){a>q?(b.width=q,b.style.top=(p-24-q/a*c)/2+"px"):(b.style.top=(p-24-c)/2+"px",b.style.paddingLeft=(q-a)/2+"px"),h.appendChild(b),b.style.left=q+"px"}var b=document.createElement("img");b.src="../"+src.____src+"/"+list[pointer+1],b.classList.add("next"),tool.getImgSize(src.____src+"/"+list[pointer+1],a)}function e(a){function b(b,d){b>q?(c.width=q,c.style.top=(p-24-q/b*d)/2+"px"):(c.style.top=(p-24-d)/2+"px",c.style.paddingLeft=(q-b)/2+"px"),h.appendChild(c),c.style.left=-q+"px",a()}var c=document.createElement("img");c.src="../"+src.____src+"/"+list[pointer-1],c.classList.add("last"),tool.getImgSize(src.____src+"/"+list[pointer-1],b)}var f={pageIni:function(){g.style.height=p+"px",g.style.width=q+"px",h.style.height=p-24+"px",h.style.width=q+"px",i.style.height=p-24+"px",i.style.width=q+"px",document.styleSheets[0].insertRule("@-webkit-keyframes leftOut{ 0%{ margin-left:0px } 100%{ margin-left:-"+q+"px } }",0),document.styleSheets[0].insertRule(".leftOut{ -webkit-animation: leftOut 0.3s; -webkit-animation-fill-mode: forwards; }",0),document.styleSheets[0].insertRule("@-webkit-keyframes rightOut{ 0%{ margin-left:0px } 100%{ margin-left:"+q+"px } }",0),document.styleSheets[0].insertRule(".rightOut{ -webkit-animation: rightOut 0.3s; -webkit-animation-fill-mode: forwards; }",0),document.styleSheets[0].insertRule("@-webkit-keyframes rightIn{ 0%{ margin-left:0px } 100%{ margin-left:-"+q+"px } }",0),document.styleSheets[0].insertRule(".rightIn{ -webkit-animation: rightIn 0.3s; -webkit-animation-fill-mode: forwards; }",0),document.styleSheets[0].insertRule("@-webkit-keyframes leftIn{ 0%{ margin-left:0px } 100%{ margin-left:"+q+"px } }",0),document.styleSheets[0].insertRule(".leftIn{ -webkit-animation: leftIn 0.3s; -webkit-animation-fill-mode: forwards; }",0)},eventReg:function(){var d=0;tool.touchWP(j,"touchend",function(){a()}),tool.touchWP(k,"touchend",function(){b()}),tool.touchWP(l,"touchend",function(b){b.stopPropagation(),d+=1;var e=setTimeout(function(){d=0,a()},300);2===d&&(d=0,clearTimeout(e),clearTimeout(e-1),c())}),tool.touchWP(m,"touchend",function(a){a.stopPropagation(),d+=1;var e=setTimeout(function(){d=0,b()},300);2===d&&(d=0,clearTimeout(e),clearTimeout(e-1),c())},!0)},createImg:function(){function a(a,c){a>q?(b.width=q,b.style.top=(p-24-q/a*c)/2+"px"):(b.style.top=(p-24-c)/2+"px",b.style.paddingLeft=(q-a)/2+"px"),h.appendChild(b),n.textContent=list[pointer],o.textContent=pointer+1+"/"+list.length,d()}var b=document.createElement("img");b.src="../"+src.____src+"/"+list[pointer],b.classList.add("pointer"),tool.getImgSize(src.____src+"/"+list[pointer],a)}},g=document.getElementById("view"),h=document.getElementById("stage"),i=(document.getElementById("curtain"),document.getElementById("touch")),j=document.getElementById("left"),k=document.getElementById("right"),l=document.getElementById("leftCenter"),m=document.getElementById("rightCenter"),n=document.getElementById("name"),o=document.getElementById("number"),p=document.documentElement.clientHeight,q=document.documentElement.clientWidth;return f}(),src,image,list,pointer,zoom;render.pageIni(),render.eventReg(),worker.getLocalStorage();