var tool=function(){var a={touchWP:function(a,b,c,d){function e(a){switch(a){case"touchstart":return"MSPointerDown";case"touchmove":return"MSPointerMove";case"touchend":return"MSPointerUp"}return""}window.navigator.msPointerEnabled?a.addEventListener(e(b),c,d):a.addEventListener(b,c,d)},getImgSize:function(a,b){var c,d,e=new Image;e.src="../"+a;var f=function(){console.log("width:"+e.width+",height:"+e.height),(e.width>0||e.height>0)&&(c=e.height,d=e.width,clearInterval(g),b(d,c))},g=setInterval(f,40)},cssAniEvent:function(a,b,c){a.addEventListener("webkit"+b,c,!1),a.addEventListener(b.toLowerCase(),c,!1)}};return a}(),worker=function(){var a={getLocalStorage:function(){src=JSON.parse(localStorage.getItem("openImageSrc")),image=JSON.parse(localStorage.getItem("openImage")),list=Object.keys(src).filter(function(a){return!!a.match(/.jpg$/)||!!a.match(/.png$/)||!!a.match(/.bmp$/)}),pointer=list.indexOf(image.____name),render.createImg()}};return a}(),render=function(){function a(){function a(){g.removeChild(e),b=document.getElementsByClassName("last")[0],b.classList.remove("last"),b.classList.add("pointer"),b.classList.add("leftIn"),g.removeChild(f),pointer-=1,m.textContent=list[pointer],n.textContent=pointer+1+"/"+list.length,c(),tool.cssAniEvent(b,"AnimationEnd",function(){b.style.left="0px",b.classList.remove("leftIn")})}if(document.getElementsByClassName("next")[0]&&0!==pointer){var b,e=document.getElementsByClassName("pointer")[0],f=document.getElementsByClassName("next")[0];e.classList.add("rightOut"),d(a)}}function b(){if(document.getElementsByClassName("next")[0]&&pointer!==list.length){var a=document.getElementsByClassName("pointer")[0],b=document.getElementsByClassName("next")[0];b.classList.remove("next"),b.classList.add("pointer"),a.classList.add("leftOut"),tool.cssAniEvent(a,"AnimationEnd",function(){g.removeChild(a),b.classList.add("rightIn"),pointer+=1,m.textContent=list[pointer],n.textContent=pointer+1+"/"+list.length,c()}),tool.cssAniEvent(b,"AnimationEnd",function(){b.style.left="0px",b.classList.remove("rightIn")})}}function c(){function a(a,c){a>p&&(b.width=p,b.style.top=(o-24-p/a*c)/2+"px"),g.appendChild(b),b.style.left=p+"px"}var b=document.createElement("img");b.src="../"+src.____src+"/"+list[pointer+1],b.classList.add("next"),tool.getImgSize(src.____src+"/"+list[pointer+1],a)}function d(a){function b(b,d){b>p&&(c.width=p,c.style.top=(o-24-p/b*d)/2+"px"),g.appendChild(c),c.style.left=-p+"px",a()}var c=document.createElement("img");c.src="../"+src.____src+"/"+list[pointer-1],c.classList.add("last"),tool.getImgSize(src.____src+"/"+list[pointer-1],b)}var e={pageIni:function(){f.style.height=o+"px",f.style.width=p+"px",g.style.height=o-24+"px",g.style.width=p+"px",h.style.height=o-24+"px",h.style.width=p+"px",document.styleSheets[0].insertRule("@-webkit-keyframes leftOut{ 0%{ margin-left:0px } 100%{ margin-left:-"+p+"px } }",0),document.styleSheets[0].insertRule(".leftOut{ -webkit-animation: leftOut 0.3s; -webkit-animation-fill-mode: forwards; }",0),document.styleSheets[0].insertRule("@-webkit-keyframes rightOut{ 0%{ margin-left:0px } 100%{ margin-left:"+p+"px } }",0),document.styleSheets[0].insertRule(".rightOut{ -webkit-animation: rightOut 0.3s; -webkit-animation-fill-mode: forwards; }",0),document.styleSheets[0].insertRule("@-webkit-keyframes rightIn{ 0%{ margin-left:0px } 100%{ margin-left:-"+p+"px } }",0),document.styleSheets[0].insertRule(".rightIn{ -webkit-animation: rightIn 0.3s; -webkit-animation-fill-mode: forwards; }",0),document.styleSheets[0].insertRule("@-webkit-keyframes leftIn{ 0%{ margin-left:0px } 100%{ margin-left:"+p+"px } }",0),document.styleSheets[0].insertRule(".leftIn{ -webkit-animation: leftIn 0.3s; -webkit-animation-fill-mode: forwards; }",0)},eventReg:function(){var c=0;tool.touchWP(i,"touchend",function(){console.log("last"),a()}),tool.touchWP(j,"touchend",function(){console.log("next"),b()}),tool.touchWP(k,"touchend",function(b){b.stopPropagation(),c+=1;var d=setTimeout(function(){c=0,console.log("last"),a()},300);2===c&&(c=0,clearTimeout(d),clearTimeout(d-1),console.log("dbTouch"))}),tool.touchWP(l,"touchend",function(a){a.stopPropagation(),c+=1;var d=setTimeout(function(){c=0,console.log("next"),b()},300);2===c&&(c=0,clearTimeout(d),clearTimeout(d-1),console.log("dbTouch"))},!0)},createImg:function(){function a(a,d){a>p&&(b.width=p,b.style.top=(o-24-p/a*d)/2+"px"),g.appendChild(b),m.textContent=list[pointer],n.textContent=pointer+1+"/"+list.length,c()}var b=document.createElement("img");b.src="../"+src.____src+"/"+list[pointer],b.classList.add("pointer"),tool.getImgSize(src.____src+"/"+list[pointer],a)}},f=document.getElementById("view"),g=document.getElementById("stage"),h=(document.getElementById("curtain"),document.getElementById("touch")),i=document.getElementById("left"),j=document.getElementById("right"),k=document.getElementById("leftCenter"),l=document.getElementById("rightCenter"),m=document.getElementById("name"),n=document.getElementById("number"),o=document.documentElement.clientHeight,p=document.documentElement.clientWidth;return e}(),src,image,list,pointer,height,width;render.pageIni(),render.eventReg(),worker.getLocalStorage();